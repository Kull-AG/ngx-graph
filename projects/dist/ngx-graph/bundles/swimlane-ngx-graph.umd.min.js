!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("dagre"),require("d3-force"),require("rxjs"),require("@angular/core"),require("@angular/animations"),require("@swimlane/ngx-charts"),require("d3-selection"),require("d3-shape"),require("d3-transition"),require("rxjs/operators"),require("transformation-matrix")):"function"==typeof define&&define.amd?define("@swimlane/ngx-graph",["exports","dagre","d3-force","rxjs","@angular/core","@angular/animations","@swimlane/ngx-charts","d3-selection","d3-shape","d3-transition","rxjs/operators","transformation-matrix"],e):e((t.swimlane=t.swimlane||{},t.swimlane["ngx-graph"]={}),null,null,t.rxjs,t.ng.core,t.ng.animations,null,null,null,null,t.rxjs.operators,null)}(this,function(t,L,e,l,a,n,o,s,h,i,d,u){"use strict";var p=function(t,e){return(p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var r=function(){return(r=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function E(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}function g(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,o,r=n.call(t),a=[];try{for(;(void 0===e||0<e--)&&!(i=r.next()).done;)a.push(i.value)}catch(s){o={error:s}}finally{try{i&&!i.done&&(n=r["return"])&&n.call(r)}finally{if(o)throw o.error}}return a}function c(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(g(arguments[e]));return t}var f={};function k(){var t=("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4);return f[t="a"+t]?k():(f[t]=!0,t)}var m="LR",y=function(){function t(){this.defaultSettings={orientation:m,marginX:20,marginY:20,edgePadding:100,rankPadding:100,nodePadding:50},this.settings={}}return t.prototype.run=function(i){this.createDagreGraph(i),L.layout(this.dagreGraph),i.edgeLabels=this.dagreGraph._edgeLabels;var t=function(t){var e=o.dagreGraph._nodes[t],n=i.nodes.find(function(t){return t.id===e.id});n.position={x:e.x,y:e.y},n.dimension={width:e.width,height:e.height}},o=this;for(var e in this.dagreGraph._nodes)t(e);return i},t.prototype.updateEdge=function(t,e){var n=t.nodes.find(function(t){return t.id===e.source}),i=t.nodes.find(function(t){return t.id===e.target}),o=n.position.y<=i.position.y?-1:1,r={x:n.position.x,y:n.position.y-o*(n.dimension.height/2)},a={x:i.position.x,y:i.position.y+o*(i.dimension.height/2)};return e.points=[r,a],t},t.prototype.createDagreGraph=function(t){var e,n,i,o;this.dagreGraph=new L.graphlib.Graph;var r=Object.assign({},this.defaultSettings,this.settings);this.dagreGraph.setGraph({rankdir:r.orientation,marginx:r.marginX,marginy:r.marginY,edgesep:r.edgePadding,ranksep:r.rankPadding,nodesep:r.nodePadding,align:r.align,acyclicer:r.acyclicer,ranker:r.ranker}),this.dagreGraph.setDefaultEdgeLabel(function(){return{}}),this.dagreNodes=t.nodes.map(function(t){var e=Object.assign({},t);return e.width=t.dimension.width,e.height=t.dimension.height,e.x=t.position.x,e.y=t.position.y,e}),this.dagreEdges=t.edges.map(function(t){var e=Object.assign({},t);return e.id||(e.id=k()),e});try{for(var a=E(this.dagreNodes),s=a.next();!s.done;s=a.next()){var h=s.value;h.width||(h.width=20),h.height||(h.height=30),this.dagreGraph.setNode(h.id,h)}}catch(l){e={error:l}}finally{try{s&&!s.done&&(n=a["return"])&&n.call(a)}finally{if(e)throw e.error}}try{for(var d=E(this.dagreEdges),u=d.next();!u.done;u=d.next()){var p=u.value;this.dagreGraph.setEdge(p.source,p.target)}}catch(g){i={error:g}}finally{try{u&&!u.done&&(o=d["return"])&&o.call(d)}finally{if(i)throw i.error}}return this.dagreGraph},t}(),v=function(){function t(){this.defaultSettings={orientation:m,marginX:20,marginY:20,edgePadding:100,rankPadding:100,nodePadding:50},this.settings={}}return t.prototype.run=function(t){var n=this;this.createDagreGraph(t),L.layout(this.dagreGraph),t.edgeLabels=this.dagreGraph._edgeLabels;var e=function(t){var e=n.dagreGraph._nodes[t.id];return r({},t,{position:{x:e.x,y:e.y},dimension:{width:e.width,height:e.height}})};return t.clusters=(t.clusters||[]).map(e),t.nodes=t.nodes.map(e),t},t.prototype.updateEdge=function(t,e){var n=t.nodes.find(function(t){return t.id===e.source}),i=t.nodes.find(function(t){return t.id===e.target}),o=n.position.y<=i.position.y?-1:1,r={x:n.position.x,y:n.position.y-o*(n.dimension.height/2)},a={x:i.position.x,y:i.position.y+o*(i.dimension.height/2)};return e.points=[r,a],t},t.prototype.createDagreGraph=function(t){var e,n,i,o,r,a,s=this;this.dagreGraph=new L.graphlib.Graph({compound:!0});var h=Object.assign({},this.defaultSettings,this.settings);this.dagreGraph.setGraph({rankdir:h.orientation,marginx:h.marginX,marginy:h.marginY,edgesep:h.edgePadding,ranksep:h.rankPadding,nodesep:h.nodePadding,align:h.align,acyclicer:h.acyclicer,ranker:h.ranker}),this.dagreGraph.setDefaultEdgeLabel(function(){return{}}),this.dagreNodes=t.nodes.map(function(t){var e=Object.assign({},t);return e.width=t.dimension.width,e.height=t.dimension.height,e.x=t.position.x,e.y=t.position.y,e}),this.dagreClusters=t.clusters||[],this.dagreEdges=t.edges.map(function(t){var e=Object.assign({},t);return e.id||(e.id=k()),e});try{for(var d=E(this.dagreNodes),u=d.next();!u.done;u=d.next()){var p=u.value;this.dagreGraph.setNode(p.id,p)}}catch(x){e={error:x}}finally{try{u&&!u.done&&(n=d["return"])&&n.call(d)}finally{if(e)throw e.error}}var l=function(e){g.dagreGraph.setNode(e.id,e),e.childNodeIds.forEach(function(t){s.dagreGraph.setParent(t,e.id)})},g=this;try{for(var c=E(this.dagreClusters),f=c.next();!f.done;f=c.next()){l(f.value)}}catch(b){i={error:b}}finally{try{f&&!f.done&&(o=c["return"])&&o.call(c)}finally{if(i)throw i.error}}try{for(var m=E(this.dagreEdges),y=m.next();!y.done;y=m.next()){var v=y.value;this.dagreGraph.setEdge(v.source,v.target)}}catch(w){r={error:w}}finally{try{y&&!y.done&&(a=m["return"])&&a.call(m)}finally{if(r)throw r.error}}return this.dagreGraph},t}(),x="LR";function b(t){return"string"==typeof t?{id:t,x:0,y:0}:t}var w={dagre:y,dagreCluster:v,dagreNodesOnly:function(){function t(){this.defaultSettings={orientation:x,marginX:20,marginY:20,edgePadding:100,rankPadding:100,nodePadding:50,curveDistance:20},this.settings={}}return t.prototype.run=function(i){var t,e;this.createDagreGraph(i),L.layout(this.dagreGraph),i.edgeLabels=this.dagreGraph._edgeLabels;var n=function(t){var e=o.dagreGraph._nodes[t],n=i.nodes.find(function(t){return t.id===e.id});n.position={x:e.x,y:e.y},n.dimension={width:e.width,height:e.height}},o=this;for(var r in this.dagreGraph._nodes)n(r);try{for(var a=E(i.edges),s=a.next();!s.done;s=a.next()){var h=s.value;this.updateEdge(i,h)}}catch(d){t={error:d}}finally{try{s&&!s.done&&(e=a["return"])&&e.call(a)}finally{if(t)throw t.error}}return i},t.prototype.updateEdge=function(t,e){var n,i,o,r,a=t.nodes.find(function(t){return t.id===e.source}),s=t.nodes.find(function(t){return t.id===e.target}),h="BT"===this.settings.orientation||"TB"===this.settings.orientation?"y":"x",d="y"===h?"x":"y",u="y"===h?"height":"width",p=a.position[h]<=s.position[h]?-1:1,l=((n={})[d]=a.position[d],n[h]=a.position[h]-p*(a.dimension[u]/2),n),g=((i={})[d]=s.position[d],i[h]=s.position[h]+p*(s.dimension[u]/2),i),c=this.settings.curveDistance||this.defaultSettings.curveDistance;e.points=[l,(o={},o[d]=l[d],o[h]=l[h]-p*c,o),(r={},r[d]=g[d],r[h]=g[h]+p*c,r),g];var f=e.source+""+e.target+"\0",m=t.edgeLabels[f];return m&&(m.points=e.points),t},t.prototype.createDagreGraph=function(t){var e,n,i,o;this.dagreGraph=new L.graphlib.Graph;var r=Object.assign({},this.defaultSettings,this.settings);this.dagreGraph.setGraph({rankdir:r.orientation,marginx:r.marginX,marginy:r.marginY,edgesep:r.edgePadding,ranksep:r.rankPadding,nodesep:r.nodePadding,align:r.align,acyclicer:r.acyclicer,ranker:r.ranker}),this.dagreGraph.setDefaultEdgeLabel(function(){return{}}),this.dagreNodes=t.nodes.map(function(t){var e=Object.assign({},t);return e.width=t.dimension.width,e.height=t.dimension.height,e.x=t.position.x,e.y=t.position.y,e}),this.dagreEdges=t.edges.map(function(t){var e=Object.assign({},t);return e.id||(e.id=k()),e});try{for(var a=E(this.dagreNodes),s=a.next();!s.done;s=a.next()){var h=s.value;h.width||(h.width=20),h.height||(h.height=30),this.dagreGraph.setNode(h.id,h)}}catch(l){e={error:l}}finally{try{s&&!s.done&&(n=a["return"])&&n.call(a)}finally{if(e)throw e.error}}try{for(var d=E(this.dagreEdges),u=d.next();!u.done;u=d.next()){var p=u.value;this.dagreGraph.setEdge(p.source,p.target)}}catch(g){i={error:g}}finally{try{u&&!u.done&&(o=d["return"])&&o.call(d)}finally{if(i)throw i.error}}return this.dagreGraph},t}(),d3:function(){function t(){this.defaultSettings={force:e.forceSimulation().force("charge",e.forceManyBody().strength(-150)).force("collide",e.forceCollide(5)),forceLink:e.forceLink().id(function(t){return t.id}).distance(function(){return 100})},this.settings={},this.outputGraph$=new l.Subject}return t.prototype.run=function(t){var e=this;return this.inputGraph=t,this.d3Graph={nodes:c(this.inputGraph.nodes.map(function(t){return r({},t)})),edges:c(this.inputGraph.edges.map(function(t){return r({},t)}))},this.outputGraph={nodes:[],edges:[],edgeLabels:[]},this.outputGraph$.next(this.outputGraph),this.settings=Object.assign({},this.defaultSettings,this.settings),this.settings.force&&this.settings.force.nodes(this.d3Graph.nodes).force("link",this.settings.forceLink.links(this.d3Graph.edges)).alpha(.5).restart().on("tick",function(){e.outputGraph$.next(e.d3GraphToOutputGraph(e.d3Graph))}),this.outputGraph$.asObservable()},t.prototype.updateEdge=function(t,e){var n=this,i=Object.assign({},this.defaultSettings,this.settings);return i.force&&i.force.nodes(this.d3Graph.nodes).force("link",i.forceLink.links(this.d3Graph.edges)).alpha(.5).restart().on("tick",function(){n.outputGraph$.next(n.d3GraphToOutputGraph(n.d3Graph))}),this.outputGraph$.asObservable()},t.prototype.d3GraphToOutputGraph=function(t){return this.outputGraph.nodes=this.d3Graph.nodes.map(function(t){return r({},t,{id:t.id||k(),position:{x:t.x,y:t.y},dimension:{width:t.dimension&&t.dimension.width||20,height:t.dimension&&t.dimension.height||20},transform:"translate("+(t.x-(t.dimension&&t.dimension.width||20)/2||0)+", "+(t.y-(t.dimension&&t.dimension.height||20)/2||0)+")"})}),this.outputGraph.edges=this.d3Graph.edges.map(function(t){return r({},t,{source:b(t.source).id,target:b(t.target).id,points:[{x:b(t.source).x,y:b(t.source).y},{x:b(t.target).x,y:b(t.target).y}]})}),this.outputGraph.edgeLabels=this.outputGraph.edges,this.outputGraph},t.prototype.onDragStart=function(e,t){this.settings.force.alphaTarget(.3).restart();var n=this.d3Graph.nodes.find(function(t){return t.id===e.id});n&&(this.draggingStart={x:t.x-n.x,y:t.y-n.y},n.fx=t.x-this.draggingStart.x,n.fy=t.y-this.draggingStart.y)},t.prototype.onDrag=function(e,t){if(e){var n=this.d3Graph.nodes.find(function(t){return t.id===e.id});n&&(n.fx=t.x-this.draggingStart.x,n.fy=t.y-this.draggingStart.y)}},t.prototype.onDragEnd=function(e,t){if(e){var n=this.d3Graph.nodes.find(function(t){return t.id===e.id});n&&(this.settings.force.alphaTarget(0),n.fx=undefined,n.fy=undefined)}},t}()},G=function(){function t(){}return t.prototype.getLayout=function(t){if(w[t])return new w[t];throw new Error("Unknown layout type '"+t+"'")},t.decorators=[{type:a.Injectable}],t}();console.log("EL REF",a.ElementRef);var T=function(r){function t(t,e,n,i){var o=r.call(this,t,e,n)||this;return o.el=t,o.zone=e,o.cd=n,o.layoutService=i,o.legend=!1,o.nodes=[],o.clusters=[],o.links=[],o.activeEntries=[],o.draggingEnabled=!0,o.panningEnabled=!0,o.enableZoom=!0,o.zoomSpeed=.1,o.minZoomLevel=.1,o.maxZoomLevel=4,o.autoZoom=!1,o.panOnZoom=!0,o.autoCenter=!1,o.activate=new a.EventEmitter,o.deactivate=new a.EventEmitter,o.graphSubscription=new l.Subscription,o.subscriptions=[],o.margin=[0,0,0,0],o.results=[],o.isPanning=!1,o.isDragging=!1,o.initialized=!1,o.graphDims={width:0,height:0},o._oldLinks=[],o.transformationMatrix=u.identity(),o._touchLastX=null,o._touchLastY=null,o.zoomBefore=1,o.groupResultsBy=function(t){return t.label},o}return function i(t,e){function n(){this.constructor=t}p(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(t,r),Object.defineProperty(t.prototype,"zoomLevel",{get:function(){return this.transformationMatrix.a},set:function(t){this.zoomTo(Number(t))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"panOffsetX",{get:function(){return this.transformationMatrix.e},set:function(t){this.panTo(Number(t),null)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"panOffsetY",{get:function(){return this.transformationMatrix.f},set:function(t){this.panTo(null,Number(t))},enumerable:!0,configurable:!0}),t.prototype.ngOnInit=function(){var t=this;this.update$&&this.subscriptions.push(this.update$.subscribe(function(){t.update()})),this.center$&&this.subscriptions.push(this.center$.subscribe(function(){t.center()})),this.zoomToFit$&&this.subscriptions.push(this.zoomToFit$.subscribe(function(){t.zoomToFit()}))},t.prototype.ngOnChanges=function(t){console.log(t);t.layout;var e=t.layoutSettings,n=t.nodes,i=t.clusters,o=t.links;this.setLayout(this.layout),e&&this.setLayoutSettings(this.layoutSettings),(n||i||o)&&this.update()},t.prototype.setLayout=function(t){this.initialized=!1,t||(t="dagre"),"string"==typeof t&&(this.layout=this.layoutService.getLayout(t),this.setLayoutSettings(this.layoutSettings))},t.prototype.setLayoutSettings=function(t){this.layout&&"string"!=typeof this.layout&&(this.layout.settings=t,this.update())},t.prototype.ngOnDestroy=function(){var t,e;r.prototype.ngOnDestroy.call(this);try{for(var n=E(this.subscriptions),i=n.next();!i.done;i=n.next()){i.value.unsubscribe()}}catch(o){t={error:o}}finally{try{i&&!i.done&&(e=n["return"])&&e.call(n)}finally{if(t)throw t.error}}this.subscriptions=null},t.prototype.ngAfterViewInit=function(){var t=this;r.prototype.ngAfterViewInit.call(this),setTimeout(function(){return t.update()})},t.prototype.update=function(){var t=this;r.prototype.update.call(this),this.curve||(this.curve=h.curveBundle.beta(1)),this.zone.run(function(){t.dims=o.calculateViewDimensions({width:t.width,height:t.height,margins:t.margin,showLegend:t.legend}),t.seriesDomain=t.getSeriesDomain(),t.setColors(),t.legendOptions=t.getLegendOptions(),t.createGraph(),t.saveZoomBeforeLoad(),t.zoomLevel=1,t.updateTransform(),t.initialized=!0})},t.prototype.draw=function(){var e=this;if(this.layout&&"string"!=typeof this.layout){this.applyNodeDimensions();var t=this.layout.run(this.graph),n=t instanceof l.Observable?t:l.of(t);this.graphSubscription.add(n.subscribe(function(t){e.graph=t,e.tick()})),n.pipe(d.first(function(t){return 0<t.nodes.length})).subscribe(function(){return e.applyNodeDimensions()}),this.restoreZoomBeforeLoad()}},t.prototype.tick=function(){var e=this;this.graph.nodes.map(function(t){t.transform="translate("+(t.position.x-t.dimension.width/2||0)+", "+(t.position.y-t.dimension.height/2||0)+")",t.data||(t.data={}),t.data.color||(t.data={color:e.colors.getColor(e.groupResultsBy(t))})}),(this.graph.clusters||[]).map(function(t){t.transform="translate("+(t.position.x-t.dimension.width/2||0)+", "+(t.position.y-t.dimension.height/2||0)+")",t.data||(t.data={}),t.data.color||(t.data={color:e.colors.getColor(e.groupResultsBy(t))})});var h=[],t=function(t){var e=d.graph.edgeLabels[t],n=t.replace(/[^\w-]*/g,""),i=d._oldLinks.find(function(t){return""+t.source+t.target===n});i||(i=d.graph.edges.find(function(t){return""+t.source+t.target===n})||e),i.oldLine=i.line;var o=e.points,r=d.generateLine(o),a=Object.assign({},i);a.line=r;var s=(a.points=o)[Math.floor(o.length/2)];s&&(a.textTransform="translate("+(s.x||0)+","+(s.y||0)+")"),a.textAngle=0,a.oldLine||(a.oldLine=a.line),d.calcDominantBaseline(a),h.push(a)},d=this;for(var n in this.graph.edgeLabels)t(n);this.graph.edges=h,this.graph.edges&&(this._oldLinks=this.graph.edges.map(function(t){var e=Object.assign({},t);return e.oldLine=t.line,e})),this.graphDims.width=Math.max.apply(Math,c(this.graph.nodes.map(function(t){return t.position.x+t.dimension.width}))),this.graphDims.height=Math.max.apply(Math,c(this.graph.nodes.map(function(t){return t.position.y+t.dimension.height}))),this.autoZoom&&this.zoomToFit(),this.autoCenter&&this.center(),requestAnimationFrame(function(){return e.redrawLines()}),this.cd.markForCheck()},t.prototype.applyNodeDimensions=function(){var a=this;this.nodeElements&&this.nodeElements.length&&this.nodeElements.map(function(t){var e,n=t.nativeElement,i=a.graph.nodes.find(function(t){return t.id===n.id});try{e=n.getBoundingClientRect()}catch(r){return}if(a.nodeHeight?i.dimension.height=a.nodeHeight:i.dimension.height=e.height,a.nodeMaxHeight&&(i.dimension.height=Math.max(i.dimension.height,a.nodeMaxHeight)),a.nodeMinHeight&&(i.dimension.height=Math.min(i.dimension.height,a.nodeMinHeight)),a.nodeWidth)i.dimension.width=a.nodeWidth;else if(n.getElementsByTagName("text").length){var o=void 0;try{o=n.getElementsByTagName("text")[0].getBBox()}catch(r){return}i.dimension.width=o.width+20}else i.dimension.width=e.width;a.nodeMaxWidth&&(i.dimension.width=Math.max(i.dimension.width,a.nodeMaxWidth)),a.nodeMinWidth&&(i.dimension.width=Math.min(i.dimension.width,a.nodeMinWidth))})},t.prototype.redrawLines=function(n){var i=this;void 0===n&&(n=!0),this.linkElements.map(function(e){var t=i.graph.edges.find(function(t){return t.id===e.nativeElement.id});t&&(s.select(e.nativeElement).select(".line").attr("d",t.oldLine).transition().duration(n?500:0).attr("d",t.line),s.select(i.chartElement.nativeElement).select("#"+t.id).attr("d",t.oldTextPath).transition().duration(n?500:0).attr("d",t.textPath))})},t.prototype.createGraph=function(){var t=this;this.graphSubscription.unsubscribe(),this.graphSubscription=new l.Subscription;var e=function(t){return t.id||(t.id=k()),t.dimension={width:30,height:30},t.position={x:0,y:0},t.data=t.data?t.data:{},t};this.graph={nodes:c(this.nodes).map(e),clusters:c(this.clusters||[]).map(e),edges:c(this.links).map(function(t){return t.id||(t.id=k()),t})},requestAnimationFrame(function(){return t.draw()})},t.prototype.calcDominantBaseline=function(t){var e=t.points[0],n=t.points[t.points.length-1];t.oldTextPath=t.textPath,n.x<e.x?(t.dominantBaseline="text-before-edge",t.textPath=this.generateLine(c(t.points).reverse())):(t.dominantBaseline="text-after-edge",t.textPath=t.line)},t.prototype.generateLine=function(t){return h.line().x(function(t){return t.x}).y(function(t){return t.y}).curve(this.curve)(t)},t.prototype.onZoom=function(t,e){var n=1+("in"===e?this.zoomSpeed:-this.zoomSpeed),i=this.zoomLevel*n;if(!(i<=this.minZoomLevel||i>=this.maxZoomLevel)&&this.enableZoom)if(!0===this.panOnZoom&&t){var o=t.clientX,r=t.clientY,a=this.chart.nativeElement.querySelector("svg"),s=a.querySelector("g.chart"),h=a.createSVGPoint();h.x=o,h.y=r;var d=h.matrixTransform(s.getScreenCTM().inverse());this.pan(d.x,d.y,1),this.zoom(n),this.pan(-d.x,-d.y,1)}else this.zoom(n)},t.prototype.pan=function(t,e,n){void 0===n&&(n=this.zoomLevel),this.transformationMatrix=u.transform(this.transformationMatrix,u.translate(t/n,e/n)),this.updateTransform()},t.prototype.panTo=function(t,e){this.transformationMatrix.e=null===t||t===undefined||isNaN(t)?this.transformationMatrix.e:Number(t),this.transformationMatrix.f=null===e||e===undefined||isNaN(e)?this.transformationMatrix.f:Number(e),this.updateTransform()},t.prototype.zoom=function(t){this.transformationMatrix=u.transform(this.transformationMatrix,u.scale(t,t)),this.updateTransform()},t.prototype.zoomTo=function(t){this.transformationMatrix.a=isNaN(t)?this.transformationMatrix.a:Number(t),this.transformationMatrix.d=isNaN(t)?this.transformationMatrix.d:Number(t),this.updateTransform()},t.prototype.onPan=function(t){this.pan(t.movementX,t.movementY)},t.prototype.onDrag=function(t){var e,n,i=this;if(this.draggingEnabled){var o=this.draggingNode;this.layout&&"string"!=typeof this.layout&&this.layout.onDrag&&this.layout.onDrag(o,t),o.position.x+=t.movementX/this.zoomLevel,o.position.y+=t.movementY/this.zoomLevel;var r=o.position.x-o.dimension.width/2,a=o.position.y-o.dimension.height/2;o.transform="translate("+r+", "+a+")";var s=function(e){if((e.target===o.id||e.source===o.id||e.target.id===o.id||e.source.id===o.id)&&h.layout&&"string"!=typeof h.layout){var t=h.layout.updateEdge(h.graph,e),n=t instanceof l.Observable?t:l.of(t);h.graphSubscription.add(n.subscribe(function(t){i.graph=t,i.redrawEdge(e)}))}},h=this;try{for(var d=E(this.graph.edges),u=d.next();!u.done;u=d.next()){s(u.value)}}catch(p){e={error:p}}finally{try{u&&!u.done&&(n=d["return"])&&n.call(d)}finally{if(e)throw e.error}}this.redrawLines(!1)}},t.prototype.redrawEdge=function(t){var e=this.generateLine(t.points);this.calcDominantBaseline(t),t.oldLine=t.line,t.line=e},t.prototype.updateTransform=function(){this.transform=u.toSVG(this.transformationMatrix)},t.prototype.onClick=function(t,e){t.origEvent=e,this.select.emit(t)},t.prototype.onDoubleClick=function(t,e){t.origEvent=e,t.isDoubleClick=!0,this.select.emit(t)},t.prototype.onActivate=function(t){-1<this.activeEntries.indexOf(t)||(this.activeEntries=c([t],this.activeEntries),this.activate.emit({value:t,entries:this.activeEntries}))},t.prototype.onDeactivate=function(t){var e=this.activeEntries.indexOf(t);this.activeEntries.splice(e,1),this.activeEntries=c(this.activeEntries),this.deactivate.emit({value:t,entries:this.activeEntries})},t.prototype.getSeriesDomain=function(){var e=this;return this.nodes.map(function(t){return e.groupResultsBy(t)}).reduce(function(t,e){return-1!==t.indexOf(e)?t:t.concat([e])},[]).sort()},t.prototype.trackLinkBy=function(t,e){return e.id},t.prototype.trackNodeBy=function(t,e){return e.id},t.prototype.setColors=function(){this.colors=new o.ColorHelper(this.scheme,"ordinal",this.seriesDomain,this.customColors)},t.prototype.getLegendOptions=function(){return{scaleType:"ordinal",domain:this.seriesDomain,colors:this.colors}},t.prototype.onMouseMove=function(t){this.isPanning&&this.panningEnabled?this.onPan(t):this.isDragging&&this.draggingEnabled&&this.onDrag(t)},t.prototype.onTouchStart=function(t){this._touchLastX=t.changedTouches[0].clientX,this._touchLastY=t.changedTouches[0].clientY,this.isPanning=!0},t.prototype.onTouchMove=function(t){if(this.isPanning&&this.panningEnabled){var e=t.changedTouches[0].clientX,n=t.changedTouches[0].clientY,i=e-this._touchLastX,o=n-this._touchLastY;this._touchLastX=e,this._touchLastY=n,this.pan(i,o)}},t.prototype.onTouchEnd=function(t){this.isPanning=!1},t.prototype.onMouseUp=function(t){this.isDragging=!1,this.isPanning=!1,this.layout&&"string"!=typeof this.layout&&this.layout.onDragEnd&&this.layout.onDragEnd(this.draggingNode,t)},t.prototype.onNodeMouseDown=function(t,e){this.draggingEnabled&&(this.isDragging=!0,this.draggingNode=e,this.layout&&"string"!=typeof this.layout&&this.layout.onDragStart&&this.layout.onDragStart(e,t))},t.prototype.center=function(){this.panTo(this.dims.width/2-this.graphDims.width*this.zoomLevel/2,this.dims.height/2-this.graphDims.height*this.zoomLevel/2)},t.prototype.zoomToFit=function(){var t=this.dims.height/this.graphDims.height,e=this.dims.width/this.graphDims.width,n=Math.min(t,e,1);n!==this.zoomLevel&&(this.zoomLevel=n,this.updateTransform())},t.prototype.restoreZoomBeforeLoad=function(){this.autoZoom?this.zoomToFit():this.zoomLevel=this.zoomBefore},t.prototype.saveZoomBeforeLoad=function(){this.zoomBefore=this.zoomLevel},t.decorators=[{type:a.Component,args:[{selector:"ngx-graph",styles:[".graph{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.graph .edge{stroke:#666;fill:none}.graph .edge .edge-label{stroke:none;font-size:12px;fill:#251e1e}.graph .panning-rect{fill:transparent;cursor:move}.graph .node-group .node:focus{outline:0}.graph .cluster rect{opacity:.2}"],template:'\n  <ngx-charts-chart [view]="[width, height]" [showLegend]="legend" [legendOptions]="legendOptions" (legendLabelClick)="onClick($event, undefined)"\n  (legendLabelActivate)="onActivate($event)" (legendLabelDeactivate)="onDeactivate($event)" mouseWheel (mouseWheelUp)="onZoom($event, \'in\')"\n  (mouseWheelDown)="onZoom($event, \'out\')">\n  <svg:g *ngIf="initialized && graph" [attr.transform]="transform" (touchstart)="onTouchStart($event)" (touchend)="onTouchEnd($event)"\n    class="graph chart">\n    <defs>\n      <ng-template *ngIf="defsTemplate" [ngTemplateOutlet]="defsTemplate">\n      </ng-template>\n      <svg:path class="text-path" *ngFor="let link of graph.edges" [attr.d]="link.textPath" [attr.id]="link.id">\n      </svg:path>\n    </defs>\n    <svg:rect class="panning-rect" [attr.width]="dims.width * 100" [attr.height]="dims.height * 100" [attr.transform]="\'translate(\' + ((-dims.width || 0) * 50) +\',\' + ((-dims.height || 0) *50) + \')\' "\n      (mousedown)="isPanning = true" />\n      <svg:g class="clusters">\n        <svg:g #clusterElement *ngFor="let node of graph.clusters; trackBy: trackNodeBy" class="node-group" [id]="node.id" [attr.transform]="node.transform"\n          (click)="onClick(node,$event)">\n          <ng-template *ngIf="clusterTemplate" [ngTemplateOutlet]="clusterTemplate" [ngTemplateOutletContext]="{ $implicit: node }">\n          </ng-template>\n          <svg:g *ngIf="!clusterTemplate" class="node cluster">\n            <svg:rect [attr.width]="node.dimension.width" [attr.height]="node.dimension.height" [attr.fill]="node.data?.color" />\n            <svg:text alignment-baseline="central" [attr.x]="10" [attr.y]="node.dimension.height / 2">{{node.label}}</svg:text>\n          </svg:g>\n        </svg:g>\n      </svg:g>\n      <svg:g class="links">\n      <svg:g #linkElement *ngFor="let link of graph.edges; trackBy: trackLinkBy" class="link-group" [id]="link.id">\n        <ng-template *ngIf="linkTemplate" [ngTemplateOutlet]="linkTemplate" [ngTemplateOutletContext]="{ $implicit: link }">\n        </ng-template>\n        <svg:path *ngIf="!linkTemplate" class="edge" [attr.d]="link.line" />\n      </svg:g>\n    </svg:g>\n    <svg:g class="nodes">\n      <svg:g #nodeElement *ngFor="let node of graph.nodes; trackBy: trackNodeBy" class="node-group" [id]="node.id" [attr.transform]="node.transform"\n        (click)="onClick(node,$event)" (mousedown)="onNodeMouseDown($event, node)" (dblclick)="onDoubleClick(node,$event)">\n        <ng-template *ngIf="nodeTemplate" [ngTemplateOutlet]="nodeTemplate" [ngTemplateOutletContext]="{ $implicit: node }">\n        </ng-template>\n        <svg:circle *ngIf="!nodeTemplate" r="10" [attr.cx]="node.dimension.width / 2" [attr.cy]="node.dimension.height / 2" [attr.fill]="node.data?.color"\n        />\n      </svg:g>\n    </svg:g>\n  </svg:g>\n</ngx-charts-chart>\n  ',encapsulation:a.ViewEncapsulation.None,changeDetection:a.ChangeDetectionStrategy.OnPush,animations:[n.trigger("link",[n.transition("* => *",[n.animate(500,n.style({transform:"*"}))])])]}]}],t.ctorParameters=function(){return[{type:a.ElementRef},{type:a.NgZone},{type:a.ChangeDetectorRef},{type:G}]},t.propDecorators={legend:[{type:a.Input}],nodes:[{type:a.Input}],clusters:[{type:a.Input}],links:[{type:a.Input}],activeEntries:[{type:a.Input}],curve:[{type:a.Input}],draggingEnabled:[{type:a.Input}],nodeHeight:[{type:a.Input}],nodeMaxHeight:[{type:a.Input}],nodeMinHeight:[{type:a.Input}],nodeWidth:[{type:a.Input}],nodeMinWidth:[{type:a.Input}],nodeMaxWidth:[{type:a.Input}],panningEnabled:[{type:a.Input}],enableZoom:[{type:a.Input}],zoomSpeed:[{type:a.Input}],minZoomLevel:[{type:a.Input}],maxZoomLevel:[{type:a.Input}],autoZoom:[{type:a.Input}],panOnZoom:[{type:a.Input}],autoCenter:[{type:a.Input}],update$:[{type:a.Input}],center$:[{type:a.Input}],zoomToFit$:[{type:a.Input}],layout:[{type:a.Input}],layoutSettings:[{type:a.Input}],activate:[{type:a.Output}],deactivate:[{type:a.Output}],linkTemplate:[{type:a.ContentChild,args:["linkTemplate"]}],nodeTemplate:[{type:a.ContentChild,args:["nodeTemplate"]}],clusterTemplate:[{type:a.ContentChild,args:["clusterTemplate"]}],defsTemplate:[{type:a.ContentChild,args:["defsTemplate"]}],chart:[{type:a.ViewChild,args:[o.ChartComponent,{read:a.ElementRef}]}],nodeElements:[{type:a.ViewChildren,args:["nodeElement"]}],linkElements:[{type:a.ViewChildren,args:["linkElement"]}],groupResultsBy:[{type:a.Input}],zoomLevel:[{type:a.Input,args:["zoomLevel"]}],panOffsetX:[{type:a.Input,args:["panOffsetX"]}],panOffsetY:[{type:a.Input,args:["panOffsetY"]}],onMouseMove:[{type:a.HostListener,args:["document:mousemove",["$event"]]}],onTouchMove:[{type:a.HostListener,args:["document:touchmove",["$event"]]}],onMouseUp:[{type:a.HostListener,args:["document:mouseup"]}]},t}(o.BaseChartComponent),D=function(){function t(){this.mouseWheelUp=new a.EventEmitter,this.mouseWheelDown=new a.EventEmitter}return t.prototype.onMouseWheelChrome=function(t){this.mouseWheelFunc(t)},t.prototype.onMouseWheelFirefox=function(t){this.mouseWheelFunc(t)},t.prototype.onMouseWheelIE=function(t){this.mouseWheelFunc(t)},t.prototype.mouseWheelFunc=function(t){window.event&&(t=window.event);var e=Math.max(-1,Math.min(1,t.wheelDelta||-t.detail));0<e?this.mouseWheelUp.emit(t):e<0&&this.mouseWheelDown.emit(t),t.returnValue=!1,t.preventDefault&&t.preventDefault()},t.decorators=[{type:a.Directive,args:[{selector:"[mouseWheel]"}]}],t.propDecorators={mouseWheelUp:[{type:a.Output}],mouseWheelDown:[{type:a.Output}],onMouseWheelChrome:[{type:a.HostListener,args:["mousewheel",["$event"]]}],onMouseWheelFirefox:[{type:a.HostListener,args:["DOMMouseScroll",["$event"]]}],onMouseWheelIE:[{type:a.HostListener,args:["onmousewheel",["$event"]]}]},t}(),M=function(){function t(){}return t.decorators=[{type:a.NgModule,args:[{imports:[o.ChartCommonModule],declarations:[T,D],exports:[T,D],providers:[G]}]}],t}(),O=function(){function t(){}return t.decorators=[{type:a.NgModule,args:[{imports:[o.NgxChartsModule],exports:[M]}]}],t}();t.NgxGraphModule=O,t.ɵa=T,t.ɵb=M,t.ɵc=G,t.ɵd=D,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=swimlane-ngx-graph.umd.min.js.map